#!/bin/bash

echo "ğŸ“¦ Applying blue deployment..."
kubectl apply -f blue_deployment.yaml

echo "ğŸ“¦ Applying green deployment..."
kubectl apply -f green_deployment.yaml

echo "ğŸ”§ Applying service to point to blue version..."
kubectl apply -f kubeservice.yaml

echo "â³ Waiting for pods to start..."
sleep 10

echo "ğŸ§ª Checking logs for blue deployment pods..."
BLUE_PODS=$(kubectl get pods -l app=messaging-app-blue -o name)
for pod in $BLUE_PODS; do
  echo "ğŸ” Logs from $pod"
  kubectl logs "$pod"
done

echo "ğŸ§ª Checking logs for green deployment pods..."
GREEN_PODS=$(kubectl get pods -l app=messaging-app-green -o name)
for pod in $GREEN_PODS; do
  echo "ğŸ” Logs from $pod"
  kubectl logs "$pod"
done

echo "âœ… Blue-green deployments and logs checked."
